<% flash.each do |msg, type| %>
<% if(msg == 'notice') %>
<p class="alert alert-success"><%= type %></p>
<% else %>
<p class="alert alert-danger"><%= type %></p>
<% end %>
<% end %>
<div class="container my-5">
    <div class="row">
        <h2 class="col"><%= @series.title %></h2>
        <button id="editBtn" type="button" class="btn btn-primary float-right">Edit Series</button>
        <%= form_for :series, url: series_path, method: "delete" do |f| %>
        <p>
            <%= f.submit("Delete Series", {:class => 'btn btn-danger'}) %>
        </p>
        <% end %>
    </div>
</div>

<% if @series.seriesPic.attached? %>
<img height="500px" width="500px" src="<%=(url_for(@series.seriesPic))%>">
<% end %>
<% @series.sermons.each do |sermon| %>
<div class='card bg-light card-body'>
    <h3><%= sermon.title %></h3>
    <p><%= sermon.description %></p>
    <small><%= sermon.sermon_time %></small>
    <%= link_to "Read More", sermon_path(sermon), :class => 'btn btn-primary' %>
</div>
<% end %>

<div class="backdrop d-none">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Series</h5>
                <button id="closeBtn" type="button" class="close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-4">
                <%= form_for :series, url: series_path, method: "patch" do |f| %>
                <% if @series.errors.any? %>
                <% @series.errors.full_messages.each do |msg| %>
                <div class='alert alert-danger'><%= msg %></div>
                <% end %>
                <% end %>
                <p>
                    <%= f.label :title %><br />
                    <%= f.text_field(:title, {:class => 'form-control'}) %>
                </p>

                <p>
                    <%= f.label "Series Photo" %><br />
                    <%= f.file_field(:seriesPic, {:class => 'form-control'}) %>
                </p>

                <p>
                    <%= f.submit({:class => 'btn btn-primary'}) %>
                </p>
                <% end %>
            </div>
        </div>
    </div>
</div>

<style>
    .backdrop {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 100vw;
        background-color: rgb(0, 0, 0, 0.6);
    }

    .modal-dialog {
        top: 15vh;
    }
</style>
<script>
    $('#editBtn').on('click', () => {
        $('.backdrop').toggleClass('d-none');
    });

    $('#closeBtn').on('click', () => {
        $('.backdrop').toggleClass('d-none');
    });

    $(document).ready(function() {
        setTimeout(function() {
            $('.alert').fadeOut();
        }, 3000);
    })
</script>